{"remainingRequest":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\babel-loader\\lib\\index.js!D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\githubdesk\\Vue-blog\\vue-blog\\src\\api\\http.js","dependencies":[{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\src\\api\\http.js","mtime":1611666114311},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJEOi9naXRodWJkZXNrL1Z1ZS1ibG9nL3Z1ZS1ibG9nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IHNlcnZpY2UgZnJvbSAnLi9jb21tb24nOwppbXBvcnQgc3RvcmUgZnJvbSAnc3RvcmUnOwppbXBvcnQgQVBJX0xJU1QgZnJvbSAnQC9jb25maWcvYXBpLmNvbmZpZyc7CmltcG9ydCBiYXNlIGZyb20gJ0AvY29uZmlnL2Jhc2UuY29uZmlnJzsKaW1wb3J0IGVuY3J5cHQgZnJvbSAnQC91dGlsL2VuY3J5cHQnOwp2YXIgVE9LRU5fTkFNRSA9IGJhc2UuVE9LRU5fTkFNRTsKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gSHR0cChfeCkgewogIHJldHVybiBfSHR0cC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfSHR0cCgpIHsKICBfSHR0cCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShfcmVmKSB7CiAgICB2YXIgdHlwZSwgZGF0YSwgX0FQSV9MSVNUJHR5cGUsIHVybCwgbWV0aG9kLCBfQVBJX0xJU1QkdHlwZSRub01lc3MsIG5vTWVzc2FnZSwgX0FQSV9MSVNUJHR5cGUkcnNhS2V5LCByc2FLZXksIF9BUElfTElTVCR0eXBlJHJlc3QsIHJlc3QsIF9BUElfTElTVCR0eXBlJHNldFRvaywgc2V0VG9rZW4sIHJlc3RTeW1ib2wsIHJlc3VsdCwgdG9rZW4sIHVpZCwgbWVzc2FnZTsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHR5cGUgPSBfcmVmLnR5cGUsIGRhdGEgPSBfcmVmLmRhdGE7CgogICAgICAgICAgICBpZiAodHlwZSBpbiBBUElfTElTVCkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FQSeivt+axgumUmeivrycpOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgX0FQSV9MSVNUJHR5cGUgPSBBUElfTElTVFt0eXBlXSwgdXJsID0gX0FQSV9MSVNUJHR5cGUudXJsLCBtZXRob2QgPSBfQVBJX0xJU1QkdHlwZS5tZXRob2QsIF9BUElfTElTVCR0eXBlJG5vTWVzcyA9IF9BUElfTElTVCR0eXBlLm5vTWVzc2FnZSwgbm9NZXNzYWdlID0gX0FQSV9MSVNUJHR5cGUkbm9NZXNzID09PSB2b2lkIDAgPyBmYWxzZSA6IF9BUElfTElTVCR0eXBlJG5vTWVzcywgX0FQSV9MSVNUJHR5cGUkcnNhS2V5ID0gX0FQSV9MSVNUJHR5cGUucnNhS2V5LCByc2FLZXkgPSBfQVBJX0xJU1QkdHlwZSRyc2FLZXkgPT09IHZvaWQgMCA/IGZhbHNlIDogX0FQSV9MSVNUJHR5cGUkcnNhS2V5LCBfQVBJX0xJU1QkdHlwZSRyZXN0ID0gX0FQSV9MSVNUJHR5cGUucmVzdCwgcmVzdCA9IF9BUElfTElTVCR0eXBlJHJlc3QgPT09IHZvaWQgMCA/IGZhbHNlIDogX0FQSV9MSVNUJHR5cGUkcmVzdCwgX0FQSV9MSVNUJHR5cGUkc2V0VG9rID0gX0FQSV9MSVNUJHR5cGUuc2V0VG9rZW4sIHNldFRva2VuID0gX0FQSV9MSVNUJHR5cGUkc2V0VG9rID09PSB2b2lkIDAgPyBmYWxzZSA6IF9BUElfTElTVCR0eXBlJHNldFRvazsKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDQ7CiAgICAgICAgICAgIG1ldGhvZCA9IG1ldGhvZC50b0xvd2VyQ2FzZSgpOwoKICAgICAgICAgICAgaWYgKHJlc3QpIHsKICAgICAgICAgICAgICByZXN0U3ltYm9sID0gdXJsLm1hdGNoKC86KC4qKSQvKVsxXTsKICAgICAgICAgICAgICB1cmwgPSB1cmwucmVwbGFjZSgvOiguKikkLywgZGF0YVtyZXN0U3ltYm9sXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICghKHJzYUtleSAmJiBkYXRhW3JzYUtleV0pKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7CiAgICAgICAgICAgIHJldHVybiBlbmNyeXB0KGRhdGFbcnNhS2V5XSk7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgZGF0YVtyc2FLZXldID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICBkYXRhID0gbWV0aG9kID09PSAnZ2V0JyA/IHsKICAgICAgICAgICAgICBwYXJhbXM6IGRhdGEKICAgICAgICAgICAgfSA6IGRhdGE7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNDsKICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2VbbWV0aG9kXSh1cmwsIGRhdGEpOwoKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICBpZiAoc2V0VG9rZW4pIHsKICAgICAgICAgICAgICB0b2tlbiA9IHJlc3VsdC50b2tlbjsKICAgICAgICAgICAgICB1aWQgPSByZXN1bHQudXNlcklkOwogICAgICAgICAgICAgIHN0b3JlLnNldCgndWlkJywgdWlkKTsgLy/mnKzlnLDlrZjlgqh0b2tlbgoKICAgICAgICAgICAgICBzdG9yZS5zZXQoVE9LRU5fTkFNRSwgdG9rZW4pOwogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdsb2dpbicpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZXN1bHQpOwoKICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOTsKICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSg0KTsKCiAgICAgICAgICAgIGlmIChfY29udGV4dC50MC5yZXNwb25zZSkgewogICAgICAgICAgICAgIG1lc3NhZ2UgPSBfY29udGV4dC50MC5yZXNwb25zZS5kYXRhLm1lc3NhZ2U7CgogICAgICAgICAgICAgIGlmICghbm9NZXNzYWdlKSB7CiAgICAgICAgICAgICAgICAvL2h0dHDlh73mlbDkvZzkuLrmj5Lku7bmjILovb3liLDkuoYgVnVl55qEcHJvdG90eXBl5LiKIHRoaXPmjIflkJF2dWXlrp7kvosKICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeS5lcnJvcih7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlamVjdChfY29udGV4dC50MCkpOwoKICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSwgdGhpcywgW1s0LCAxOV1dKTsKICB9KSk7CiAgcmV0dXJuIF9IdHRwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0="},{"version":3,"sources":["D:/githubdesk/Vue-blog/vue-blog/src/api/http.js"],"names":["service","store","API_LIST","base","encrypt","TOKEN_NAME","Http","type","data","Error","url","method","noMessage","rsaKey","rest","setToken","toLowerCase","restSymbol","match","replace","params","result","token","uid","userId","set","$store","dispatch","response","message","$notify","error","title","Promise","reject"],"mappings":";;;;;;AAAA,OAAOA,OAAP,MAAoB,UAApB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,qBAArB;AACA,OAAOC,IAAP,MAAiB,sBAAjB;AACA,OAAOC,OAAP,MAAoB,gBAApB;IAEQC,U,GAAeF,I,CAAfE,U;AACR,wBAA8BC,IAA9B;AAAA;AAAA;;;kEAAe;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAuBC,YAAAA,IAAvB,QAAuBA,IAAvB,EAA6BC,IAA7B,QAA6BA,IAA7B;;AAAA,gBACPD,IAAI,IAAIL,QADD;AAAA;AAAA;AAAA;;AAAA,kBAEL,IAAIO,KAAJ,CAAU,SAAV,CAFK;;AAAA;AAAA,6BAI4EP,QAAQ,CAACK,IAAD,CAJpF,EAIPG,GAJO,kBAIPA,GAJO,EAIFC,MAJE,kBAIFA,MAJE,yCAIMC,SAJN,EAIMA,SAJN,sCAIkB,KAJlB,iEAIyBC,MAJzB,EAIyBA,MAJzB,sCAIkC,KAJlC,+DAIyCC,IAJzC,EAIyCA,IAJzC,oCAIgD,KAJhD,+DAIuDC,QAJvD,EAIuDA,QAJvD,sCAIkE,KAJlE;AAAA;AAMXJ,YAAAA,MAAM,GAAGA,MAAM,CAACK,WAAP,EAAT;;AACA,gBAAIF,IAAJ,EAAU;AACJG,cAAAA,UADI,GACSP,GAAG,CAACQ,KAAJ,CAAU,QAAV,EAAoB,CAApB,CADT;AAERR,cAAAA,GAAG,GAAGA,GAAG,CAACS,OAAJ,CAAY,QAAZ,EAAsBX,IAAI,CAACS,UAAD,CAA1B,CAAN;AACD;;AAVU,kBAWPJ,MAAM,IAAIL,IAAI,CAACK,MAAD,CAXP;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAYYT,OAAO,CAACI,IAAI,CAACK,MAAD,CAAL,CAZnB;;AAAA;AAYTL,YAAAA,IAAI,CAACK,MAAD,CAZK;;AAAA;AAcXL,YAAAA,IAAI,GAAGG,MAAM,KAAK,KAAX,GAAmB;AAAES,cAAAA,MAAM,EAAEZ;AAAV,aAAnB,GAAsCA,IAA7C;AAdW;AAAA,mBAgBQR,OAAO,CAACW,MAAD,CAAP,CAAgBD,GAAhB,EAAqBF,IAArB,CAhBR;;AAAA;AAgBPa,YAAAA,MAhBO;;AAkBX,gBAAIN,QAAJ,EAAc;AACRO,cAAAA,KADQ,GACAD,MAAM,CAACC,KADP;AAERC,cAAAA,GAFQ,GAEFF,MAAM,CAACG,MAFL;AAGZvB,cAAAA,KAAK,CAACwB,GAAN,CAAU,KAAV,EAAiBF,GAAjB,EAHY,CAIZ;;AACAtB,cAAAA,KAAK,CAACwB,GAAN,CAAUpB,UAAV,EAAsBiB,KAAtB;AACA,mBAAKI,MAAL,CAAYC,QAAZ,CAAqB,OAArB;AAED;;AA1BU,6CA2BJN,MA3BI;;AAAA;AAAA;AAAA;;AA6BX,gBAAI,YAAMO,QAAV,EAAoB;AACdC,cAAAA,OADc,GACJ,YAAMD,QAAN,CAAepB,IAAf,CAAoBqB,OADhB;;AAElB,kBAAI,CAACjB,SAAL,EAAgB;AACd;AACA,qBAAKkB,OAAL,CAAaC,KAAb,CAAmB;AACjBC,kBAAAA,KAAK,EAAE,IADU;AAEjBH,kBAAAA,OAAO,EAAPA;AAFiB,iBAAnB;AAID;AACF;;AAtCU,6CAuCJI,OAAO,CAACC,MAAR,aAvCI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import service from './common'\r\nimport store from 'store'\r\nimport API_LIST from '@/config/api.config'\r\nimport base from '@/config/base.config'\r\nimport encrypt from '@/util/encrypt'\r\n\r\nconst { TOKEN_NAME } = base\r\nexport default async function Http ({ type, data }) {\r\n  if (!(type in API_LIST)) {\r\n    throw new Error('API请求错误')\r\n  }\r\n  let { url, method, noMessage = false, rsaKey = false, rest = false, setToken = false } = API_LIST[type]\r\n  try {\r\n    method = method.toLowerCase()\r\n    if (rest) {\r\n      let restSymbol = url.match(/:(.*)$/)[1]\r\n      url = url.replace(/:(.*)$/, data[restSymbol])\r\n    }\r\n    if (rsaKey && data[rsaKey]) {\r\n      data[rsaKey] = await encrypt(data[rsaKey])\r\n    }\r\n    data = method === 'get' ? { params: data } : data\r\n\r\n    let result = await service[method](url, data)\r\n\r\n    if (setToken) {\r\n      let token = result.token;\r\n      let uid = result.userId\r\n      store.set('uid', uid)\r\n      //本地存储token\r\n      store.set(TOKEN_NAME, token)\r\n      this.$store.dispatch('login')\r\n     \r\n    }\r\n    return result\r\n  } catch (error) {\r\n    if (error.response) {\r\n      let message = error.response.data.message\r\n      if (!noMessage) {\r\n        //http函数作为插件挂载到了 Vue的prototype上 this指向vue实例\r\n        this.$notify.error({\r\n          title: '错误',\r\n          message\r\n        })\r\n      }\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n}\r\n"]}]}