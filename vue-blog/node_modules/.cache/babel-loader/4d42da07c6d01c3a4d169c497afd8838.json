{"remainingRequest":"D:\\预科班6.2\\前端框架班\\vue\\Vue第二十二天 Vue高级  Vue  vue-blog http封装\\案例\\vue-blog\\node_modules\\babel-loader\\lib\\index.js!D:\\预科班6.2\\前端框架班\\vue\\Vue第二十二天 Vue高级  Vue  vue-blog http封装\\案例\\vue-blog\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\预科班6.2\\前端框架班\\vue\\Vue第二十二天 Vue高级  Vue  vue-blog http封装\\案例\\vue-blog\\src\\api\\http.js","dependencies":[{"path":"D:\\预科班6.2\\前端框架班\\vue\\Vue第二十二天 Vue高级  Vue  vue-blog http封装\\案例\\vue-blog\\src\\api\\http.js","mtime":1611587031712},{"path":"D:\\预科班6.2\\前端框架班\\vue\\Vue第二十二天 Vue高级  Vue  vue-blog http封装\\案例\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\预科班6.2\\前端框架班\\vue\\Vue第二十二天 Vue高级  Vue  vue-blog http封装\\案例\\vue-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\预科班6.2\\前端框架班\\vue\\Vue第二十二天 Vue高级  Vue  vue-blog http封装\\案例\\vue-blog\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJEOi9cdTk4ODRcdTc5RDFcdTczRUQ2LjIvXHU1MjREXHU3QUVGXHU2ODQ2XHU2N0I2XHU3M0VEL3Z1ZS9WdWVcdTdCMkNcdTRFOENcdTUzNDFcdTRFOENcdTU5MjkgVnVlXHU5QUQ4XHU3RUE3ICBWdWUgIHZ1ZS1ibG9nIGh0dHBcdTVDMDFcdTg4QzUvXHU2ODQ4XHU0RjhCL3Z1ZS1ibG9nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IHNlcnZpY2UgZnJvbSAnLi9jb21tb24nOwppbXBvcnQgdnVleCBmcm9tICdAL3N0b3JlJzsKaW1wb3J0IHN0b3JlIGZyb20gJ3N0b3JlJzsKaW1wb3J0IEFQSV9MSVNUIGZyb20gJ0AvY29uZmlnL2FwaS5jb25maWcnOwppbXBvcnQgYmFzZSBmcm9tICdAL2NvbmZpZy9iYXNlLmNvbmZpZyc7CmltcG9ydCBlbmNyeXB0IGZyb20gJ0AvdXRpbC9lbmNyeXB0JzsKdmFyIFRPS0VOX05BTUUgPSBiYXNlLlRPS0VOX05BTUU7CmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEh0dHAoX3gpIHsKICByZXR1cm4gX0h0dHAuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX0h0dHAoKSB7CiAgX0h0dHAgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoX3JlZikgewogICAgdmFyIHR5cGUsIGRhdGEsIF9BUElfTElTVCR0eXBlLCB1cmwsIG1ldGhvZCwgX0FQSV9MSVNUJHR5cGUkbm9NZXNzLCBub01lc3NhZ2UsIF9BUElfTElTVCR0eXBlJHJzYUtleSwgcnNhS2V5LCBfQVBJX0xJU1QkdHlwZSRyZXN0LCByZXN0LCBfQVBJX0xJU1QkdHlwZSRzZXRUb2ssIHNldFRva2VuLCByZXN0U3ltYm9sLCByZXN1bHQsIHRva2VuLCB1aWQsIG1lc3NhZ2U7CgogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICB0eXBlID0gX3JlZi50eXBlLCBkYXRhID0gX3JlZi5kYXRhOwoKICAgICAgICAgICAgaWYgKHR5cGUgaW4gQVBJX0xJU1QpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBUEnor7fmsYLplJnor68nKTsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIF9BUElfTElTVCR0eXBlID0gQVBJX0xJU1RbdHlwZV0sIHVybCA9IF9BUElfTElTVCR0eXBlLnVybCwgbWV0aG9kID0gX0FQSV9MSVNUJHR5cGUubWV0aG9kLCBfQVBJX0xJU1QkdHlwZSRub01lc3MgPSBfQVBJX0xJU1QkdHlwZS5ub01lc3NhZ2UsIG5vTWVzc2FnZSA9IF9BUElfTElTVCR0eXBlJG5vTWVzcyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfQVBJX0xJU1QkdHlwZSRub01lc3MsIF9BUElfTElTVCR0eXBlJHJzYUtleSA9IF9BUElfTElTVCR0eXBlLnJzYUtleSwgcnNhS2V5ID0gX0FQSV9MSVNUJHR5cGUkcnNhS2V5ID09PSB2b2lkIDAgPyBmYWxzZSA6IF9BUElfTElTVCR0eXBlJHJzYUtleSwgX0FQSV9MSVNUJHR5cGUkcmVzdCA9IF9BUElfTElTVCR0eXBlLnJlc3QsIHJlc3QgPSBfQVBJX0xJU1QkdHlwZSRyZXN0ID09PSB2b2lkIDAgPyBmYWxzZSA6IF9BUElfTElTVCR0eXBlJHJlc3QsIF9BUElfTElTVCR0eXBlJHNldFRvayA9IF9BUElfTElTVCR0eXBlLnNldFRva2VuLCBzZXRUb2tlbiA9IF9BUElfTElTVCR0eXBlJHNldFRvayA9PT0gdm9pZCAwID8gZmFsc2UgOiBfQVBJX0xJU1QkdHlwZSRzZXRUb2s7CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA0OwogICAgICAgICAgICBtZXRob2QgPSBtZXRob2QudG9Mb3dlckNhc2UoKTsKCiAgICAgICAgICAgIGlmIChyZXN0KSB7CiAgICAgICAgICAgICAgcmVzdFN5bWJvbCA9IHVybC5tYXRjaCgvOiguKikkLylbMV07CiAgICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoLzooLiopJC8sIGRhdGFbcmVzdFN5bWJvbF0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIShyc2FLZXkgJiYgZGF0YVtyc2FLZXldKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICByZXR1cm4gZW5jcnlwdChkYXRhW3JzYUtleV0pOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIGRhdGFbcnNhS2V5XSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgZGF0YSA9IG1ldGhvZCA9PT0gJ2dldCcgPyB7CiAgICAgICAgICAgICAgcGFyYW1zOiBkYXRhCiAgICAgICAgICAgIH0gOiBkYXRhOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlW21ldGhvZF0odXJsLCBkYXRhKTsKCiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgaWYgKHNldFRva2VuKSB7CiAgICAgICAgICAgICAgdG9rZW4gPSByZXN1bHQudG9rZW47CiAgICAgICAgICAgICAgdWlkID0gcmVzdWx0LnVzZXJJZDsKICAgICAgICAgICAgICBzdG9yZS5zZXQoJ3VpZCcsIHVpZCk7IC8v5pys5Zyw5a2Y5YKodG9rZW4KCiAgICAgICAgICAgICAgc3RvcmUuc2V0KFRPS0VOX05BTUUsIHRva2VuKTsKICAgICAgICAgICAgICB2dWV4LmRpc3BhdGNoKCdsb2dpbicpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZXN1bHQpOwoKICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOTsKICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSg0KTsKCiAgICAgICAgICAgIGlmIChfY29udGV4dC50MC5yZXNwb25zZSkgewogICAgICAgICAgICAgIG1lc3NhZ2UgPSBfY29udGV4dC50MC5yZXNwb25zZS5kYXRhLm1lc3NhZ2U7CgogICAgICAgICAgICAgIGlmICghbm9NZXNzYWdlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTsgLy8gbmV3IE1lc3NhZ2UobWVzc2FnZSkuZGFuZ2VyKCkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVqZWN0KF9jb250ZXh0LnQwKSk7CgogICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzQsIDE5XV0pOwogIH0pKTsKICByZXR1cm4gX0h0dHAuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQ=="},{"version":3,"sources":["D:/预科班6.2/前端框架班/vue/Vue第二十二天 Vue高级  Vue  vue-blog http封装/案例/vue-blog/src/api/http.js"],"names":["service","vuex","store","API_LIST","base","encrypt","TOKEN_NAME","Http","type","data","Error","url","method","noMessage","rsaKey","rest","setToken","toLowerCase","restSymbol","match","replace","params","result","token","uid","userId","set","dispatch","response","message","console","log","Promise","reject"],"mappings":";;;;;;AAAA,OAAOA,OAAP,MAAoB,UAApB;AACA,OAAOC,IAAP,MAAiB,SAAjB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,qBAArB;AACA,OAAOC,IAAP,MAAiB,sBAAjB;AACA,OAAOC,OAAP,MAAoB,gBAApB;IAEQC,U,GAAeF,I,CAAfE,U;AACR,wBAA8BC,IAA9B;AAAA;AAAA;;;kEAAe;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAuBC,YAAAA,IAAvB,QAAuBA,IAAvB,EAA6BC,IAA7B,QAA6BA,IAA7B;;AAAA,gBACPD,IAAI,IAAIL,QADD;AAAA;AAAA;AAAA;;AAAA,kBAEL,IAAIO,KAAJ,CAAU,SAAV,CAFK;;AAAA;AAAA,6BAI4EP,QAAQ,CAACK,IAAD,CAJpF,EAIPG,GAJO,kBAIPA,GAJO,EAIFC,MAJE,kBAIFA,MAJE,yCAIMC,SAJN,EAIMA,SAJN,sCAIkB,KAJlB,iEAIyBC,MAJzB,EAIyBA,MAJzB,sCAIkC,KAJlC,+DAIyCC,IAJzC,EAIyCA,IAJzC,oCAIgD,KAJhD,+DAIuDC,QAJvD,EAIuDA,QAJvD,sCAIkE,KAJlE;AAAA;AAMXJ,YAAAA,MAAM,GAAGA,MAAM,CAACK,WAAP,EAAT;;AACA,gBAAIF,IAAJ,EAAU;AACJG,cAAAA,UADI,GACSP,GAAG,CAACQ,KAAJ,CAAU,QAAV,EAAoB,CAApB,CADT;AAERR,cAAAA,GAAG,GAAGA,GAAG,CAACS,OAAJ,CAAY,QAAZ,EAAsBX,IAAI,CAACS,UAAD,CAA1B,CAAN;AACD;;AAVU,kBAWPJ,MAAM,IAAIL,IAAI,CAACK,MAAD,CAXP;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAYYT,OAAO,CAACI,IAAI,CAACK,MAAD,CAAL,CAZnB;;AAAA;AAYTL,YAAAA,IAAI,CAACK,MAAD,CAZK;;AAAA;AAcXL,YAAAA,IAAI,GAAGG,MAAM,KAAK,KAAX,GAAmB;AAAES,cAAAA,MAAM,EAAEZ;AAAV,aAAnB,GAAsCA,IAA7C;AAdW;AAAA,mBAgBQT,OAAO,CAACY,MAAD,CAAP,CAAgBD,GAAhB,EAAqBF,IAArB,CAhBR;;AAAA;AAgBPa,YAAAA,MAhBO;;AAkBX,gBAAIN,QAAJ,EAAc;AACRO,cAAAA,KADQ,GACAD,MAAM,CAACC,KADP;AAERC,cAAAA,GAFQ,GAEFF,MAAM,CAACG,MAFL;AAGZvB,cAAAA,KAAK,CAACwB,GAAN,CAAU,KAAV,EAAiBF,GAAjB,EAHY,CAIZ;;AACAtB,cAAAA,KAAK,CAACwB,GAAN,CAAUpB,UAAV,EAAsBiB,KAAtB;AACAtB,cAAAA,IAAI,CAAC0B,QAAL,CAAc,OAAd;AACD;;AAzBU,6CA0BJL,MA1BI;;AAAA;AAAA;AAAA;;AA4BX,gBAAI,YAAMM,QAAV,EAAoB;AACdC,cAAAA,OADc,GACJ,YAAMD,QAAN,CAAenB,IAAf,CAAoBoB,OADhB;;AAElB,kBAAI,CAAChB,SAAL,EAAgB;AACdiB,gBAAAA,OAAO,CAACC,GAAR,CAAYF,OAAZ,EADc,CAEd;AACD;AACF;;AAlCU,6CAmCJG,OAAO,CAACC,MAAR,aAnCI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import service from './common'\r\nimport vuex from '@/store'\r\nimport store from 'store'\r\nimport API_LIST from '@/config/api.config'\r\nimport base from '@/config/base.config'\r\nimport encrypt from '@/util/encrypt'\r\n\r\nconst { TOKEN_NAME } = base\r\nexport default async function Http ({ type, data }) {\r\n  if (!(type in API_LIST)) {\r\n    throw new Error('API请求错误')\r\n  }\r\n  let { url, method, noMessage = false, rsaKey = false, rest = false, setToken = false } = API_LIST[type]\r\n  try {\r\n    method = method.toLowerCase()\r\n    if (rest) {\r\n      let restSymbol = url.match(/:(.*)$/)[1]\r\n      url = url.replace(/:(.*)$/, data[restSymbol])\r\n    }\r\n    if (rsaKey && data[rsaKey]) {\r\n      data[rsaKey] = await encrypt(data[rsaKey])\r\n    }\r\n    data = method === 'get' ? { params: data } : data\r\n\r\n    let result = await service[method](url, data)\r\n\r\n    if (setToken) {\r\n      let token = result.token;\r\n      let uid = result.userId\r\n      store.set('uid', uid)\r\n      //本地存储token\r\n      store.set(TOKEN_NAME, token)\r\n      vuex.dispatch('login')\r\n    }\r\n    return result\r\n  } catch (error) {\r\n    if (error.response) {\r\n      let message = error.response.data.message\r\n      if (!noMessage) {\r\n        console.log(message)\r\n        // new Message(message).danger()\r\n      }\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n}\r\n"]}]}