{"remainingRequest":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\githubdesk\\Vue-blog\\vue-blog\\src\\views\\Socket.vue?vue&type=style&index=0&id=1f2740ad&lang=stylus&scoped=true&","dependencies":[{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\src\\views\\Socket.vue","mtime":1762832105363},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\stylus-loader\\index.js","mtime":1519606876000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQovLyDlhajlsYDmoLflvI/lj5jph48NCiRwcmltYXJ5LWNvbG9yID0gIzQwOUVGRg0KJHNlY29uZGFyeS1jb2xvciA9ICM2N0MyM0ENCiRncmF5LWxpZ2h0ID0gI0Y1RjdGQQ0KJGdyYXkgPSAjQzBDNENDDQokZ3JheS1kYXJrID0gIzkwOTM5OQ0KJHRleHQtY29sb3IgPSAjMzAzMTMzDQokYmctY29sb3IgPSAjRjdGOUZDDQokYm9yZGVyLXJhZGl1cyA9IDE4cHgNCiRzaGFkb3cgPSAwIDJweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4wOCkNCg0KLmJsb2ctY2hhdA0KICBkaXNwbGF5IGZsZXgNCiAgZmxleC1kaXJlY3Rpb24gY29sdW1uDQogIHdpZHRoIDEwMCUNCiAgbWF4LXdpZHRoIDgwMHB4ICAvLyDpmZDliLbmnIDlpKflrr3luqYNCiAgbWFyZ2luIDEwcHggYXV0bw0KICBiYWNrZ3JvdW5kLWNvbG9yICNmZmYNCiAgYm9yZGVyLXJhZGl1cyAxMnB4DQogIGJveC1zaGFkb3cgMCA0cHggMjBweCByZ2JhKDAsIDAsIDAsIDAuMSkNCiAgaGVpZ2h0IDY4dmgNCiAgb3ZlcmZsb3cgaGlkZGVuDQogIHRyYW5zaXRpb24gYWxsIDAuM3MgZWFzZQ0KDQogIC8vIOWTjeW6lOW8j+iwg+aVtA0KICBAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpDQogICAgd2lkdGggOTUlDQogICAgaGVpZ2h0IDc1dmgNCg0KLmJsb2ctY2hhdC0taGVhZGVyDQogIGRpc3BsYXkgZmxleA0KICBhbGlnbi1pdGVtcyBjZW50ZXINCiAgcGFkZGluZyAxNnB4IDIwcHgNCiAgYmFja2dyb3VuZC1jb2xvciAkcHJpbWFyeS1jb2xvcg0KICBjb2xvciAjZmZmDQogIGZvbnQtc2l6ZSAxOHB4DQogIGZvbnQtd2VpZ2h0IDUwMA0KDQogIGkuZWwtaWNvbi1jb21tZW50cw0KICAgIG1hcmdpbi1yaWdodCA4cHgNCiAgICBmb250LXNpemUgMjBweA0KDQouYmxvZy1jaGF0LS1jb250ZW50DQogIGZsZXggMQ0KICBwYWRkaW5nIDIwcHgNCiAgb3ZlcmZsb3cteSBhdXRvDQogIGJhY2tncm91bmQtY29sb3IgJGJnLWNvbG9yDQogIHNjcm9sbC1iZWhhdmlvciBzbW9vdGggIC8vIOW5s+a7kea7muWKqA0KDQogIC8vIOa7muWKqOadoeagt+W8j++8iOWmguaenOmcgOimgemakOiXj++8jOWPr+azqOmHiui/meaute+8iQ0KICAmOjotd2Via2l0LXNjcm9sbGJhcg0KICAgIHdpZHRoIDZweA0KICAgIGhlaWdodCA2cHgNCg0KICAmOjotd2Via2l0LXNjcm9sbGJhci10aHVtYg0KICAgIGJhY2tncm91bmQtY29sb3IgJGdyYXkNCiAgICBib3JkZXItcmFkaXVzIDNweA0KDQogICY6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrDQogICAgYmFja2dyb3VuZC1jb2xvciB0cmFuc3BhcmVudA0KDQovLyDkv67lpI3moLjlv4PvvJrmtojmga/pobnlrrnlmajmoLflvI8NCi5ibG9nLWNoYXQtLWl0ZW0NCiAgZGlzcGxheSBmbGV4DQogIG1hcmdpbi1ib3R0b20gMTZweA0KICBhbmltYXRpb24gZmFkZUluIDAuM3MgZWFzZSAgLy8g5raI5oGv5Ye6546w5Yqo55S7DQogIHdpZHRoOiAxMDAlICAvLyDnoa7kv53ljaDmu6Hlrr3luqYNCg0KICAvLyDlt6bkvqfmtojmga/vvIjku5bkurrvvIktIOmdoOW3pg0KICAmLmxlZnQNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQNCiAgICBmbGV4LWRpcmVjdGlvbjogcm93DQoNCiAgICAuYmxvZy1jaGF0LS1uaWtuYW1lDQogICAgICBtYXJnaW4tcmlnaHQ6IDhweA0KICAgICAgY29sb3IgJGdyYXktZGFyaw0KICAgICAgZm9udC1zaXplIDEycHgNCiAgICAgIGFsaWduLXNlbGY6IGZsZXgtc3RhcnQNCiAgICAgIG1hcmdpbi10b3A6IDJweA0KDQogICAgLmJsb2ctY2hhdC0tYm94DQogICAgICBiYWNrZ3JvdW5kLWNvbG9yICNmZmYNCiAgICAgIGJvcmRlciAxcHggc29saWQgI0U1RTZFQg0KICAgICAgbWFyZ2luLWxlZnQ6IDAgIC8vIOenu+mZpOWkmuS9mei+uei3nQ0KDQogIC8vIOWPs+S+p+a2iOaBr++8iOiHquW3se+8iS0g6Z2g5Y+z77yI5YWz6ZSu5L+u5aSN77yJDQogICYucmlnaHQNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kICAvLyDmlbTkvZPpnaDlj7MNCiAgICBmbGV4LWRpcmVjdGlvbjogcm93ICAvLyDkuI3pnIDopoHlj43lkJHvvIznm7TmjqXosIPmlbTlhoXpg6jpobrluo8NCiAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydA0KDQogICAgLy8g6Ieq5bex55qE5pi156ew5Zyo5Y+z6L6577yM5omA5LulbWFyZ2luLWxlZnQNCiAgICAuYmxvZy1jaGF0LS1uaWtuYW1lDQogICAgICBtYXJnaW4tbGVmdDogOHB4DQogICAgICBjb2xvciAkZ3JheS1kYXJrDQogICAgICBmb250LXNpemUgMTJweA0KICAgICAgYWxpZ24tc2VsZjogZmxleC1zdGFydA0KICAgICAgbWFyZ2luLXRvcDogMnB4DQogICAgICBvcmRlcjogMiAgLy8g6K6p5pi156ew5Zyo5raI5oGv5qGG5Y+z6L65DQoNCiAgICAuYmxvZy1jaGF0LS1ib3gNCiAgICAgIGJhY2tncm91bmQtY29sb3IgJHByaW1hcnktY29sb3INCiAgICAgIGNvbG9yICNmZmYNCiAgICAgIG1hcmdpbi1yaWdodDogMCAgLy8g56e76Zmk5aSa5L2Z6L656LedDQogICAgICBvcmRlcjogMSAgLy8g6K6p5raI5oGv5qGG5Zyo5pi156ew5bem6L65DQoNCiAgLy8g5Lit6Ze057O757uf5raI5oGvDQogICYuY2VudGVyDQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXINCiAgICBmbGV4LWRpcmVjdGlvbjogcm93DQoNCiAgICAuYmxvZy1jaGF0LS1ib3gNCiAgICAgIGJhY2tncm91bmQtY29sb3IgI0YwRjJGNQ0KICAgICAgY29sb3IgJGdyYXktZGFyaw0KICAgICAgZm9udC1zaXplIDEzcHgNCiAgICAgIHBhZGRpbmcgNnB4IDEycHgNCiAgICAgIGJvcmRlci1yYWRpdXMgMTJweA0KICAgICAgbWF4LXdpZHRoOiA2MCUNCg0KLmJsb2ctY2hhdC0tbmlrbmFtZQ0KICBmb250LXNpemUgMTJweA0KICBmb250LXdlaWdodCA1MDANCiAgbWFyZ2luLWJvdHRvbSA0cHgNCiAgZGlzcGxheTogaW5saW5lLWJsb2NrDQoNCi5ibG9nLWNoYXQtLWJveA0KICBtYXgtd2lkdGg6IDcwJSAgLy8g6ZmQ5Yi25raI5oGv5pyA5aSn5a695bqmDQogIHBhZGRpbmc6IDEwcHggMTRweA0KICBib3JkZXItcmFkaXVzICRib3JkZXItcmFkaXVzDQogIGJveC1zaGFkb3cgJHNoYWRvdw0KICBwb3NpdGlvbjogcmVsYXRpdmUNCiAgdHJhbnNpdGlvbiBhbGwgMC4ycyBlYXNlDQogIHdvcmQtd3JhcDogYnJlYWstd29yZCAgLy8g56Gu5L+d6ZW/5paH5pys5o2i6KGMDQoNCiAgLy8g57O757uf5raI5oGv5qC35byPDQogICYuYWN0aW9uDQogICAgYmFja2dyb3VuZC1jb2xvciAjRjBGMkY1DQogICAgY29sb3IgJGdyYXktZGFyaw0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KICAgIGJveC1zaGFkb3c6IG5vbmUNCiAgICBib3JkZXItcmFkaXVzOiAxMnB4DQoNCiAgLy8g5rCU5rOh5bCW6KeSIC0g5bem5L6n5raI5oGvDQogIC5sZWZ0ICY6OmJlZm9yZQ0KICAgIGNvbnRlbnQ6ICcnDQogICAgcG9zaXRpb246IGFic29sdXRlDQogICAgbGVmdDogLThweA0KICAgIHRvcDogMTJweA0KICAgIHdpZHRoOiAwDQogICAgaGVpZ2h0OiAwDQogICAgYm9yZGVyLXRvcDogOHB4IHNvbGlkIHRyYW5zcGFyZW50DQogICAgYm9yZGVyLWJvdHRvbTogOHB4IHNvbGlkIHRyYW5zcGFyZW50DQogICAgYm9yZGVyLXJpZ2h0OiA4cHggc29saWQgI2ZmZg0KICAgIHotaW5kZXg6IDENCg0KICAvLyDmsJTms6HlsJbop5IgLSDlj7Pkvqfmtojmga/vvIjkv67lpI3mlrnlkJHvvIkNCiAgLnJpZ2h0ICY6OmJlZm9yZQ0KICAgIGNvbnRlbnQ6ICcnDQogICAgcG9zaXRpb246IGFic29sdXRlDQogICAgcmlnaHQ6IC04cHggIC8vIOWwluinkuWcqOWPs+S+pw0KICAgIHRvcDogMTJweA0KICAgIHdpZHRoOiAwDQogICAgaGVpZ2h0OiAwDQogICAgYm9yZGVyLXRvcDogOHB4IHNvbGlkIHRyYW5zcGFyZW50DQogICAgYm9yZGVyLWJvdHRvbTogOHB4IHNvbGlkIHRyYW5zcGFyZW50DQogICAgYm9yZGVyLWxlZnQ6IDhweCBzb2xpZCAkcHJpbWFyeS1jb2xvciAgLy8g5LiO6Ieq5bex5raI5oGv5qGG6aKc6Imy5LiA6Ie0DQogICAgei1pbmRleDogMQ0KDQouYmxvZy1jaGF0LS10aW1lDQogIGZvbnQtc2l6ZTogMTFweA0KICBjb2xvciAkZ3JheQ0KICBtYXJnaW4tYm90dG9tOiA0cHgNCiAgZGlzcGxheTogYmxvY2sNCg0KICAvLyDoh6rlt7Hmtojmga/nmoTml7bpl7TpopzoibINCiAgLnJpZ2h0ICYNCiAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjcpDQoNCi5ibG9nLWNoYXQtLW1zZw0KICBmb250LXNpemU6IDE0cHgNCiAgbGluZS1oZWlnaHQ6IDEuNg0KICBtYXJnaW46IDANCiAgd29yZC1icmVhazogYnJlYWstYWxsICAvLyDoh6rliqjmjaLooYwNCiAgd2hpdGUtc3BhY2U6IG5vcm1hbA0KDQouYmxvZy1jaGF0LS1ib3R0b20NCiAgZGlzcGxheTogZmxleA0KICBnYXA6IDEycHgNCiAgcGFkZGluZzogMTZweCAyMHB4DQogIGJhY2tncm91bmQtY29sb3IgI2ZmZg0KICBib3JkZXItdG9wOiAxcHggc29saWQgI0YwRjJGNQ0KICBhbGlnbi1pdGVtczogY2VudGVyICAvLyDovpPlhaXmoYblkozmjInpkq7lnoLnm7TlsYXkuK0NCg0KLmNoYXQtaW5wdXQNCiAgZmxleDogMQ0KICBib3JkZXItcmFkaXVzOiAyNHB4ICFpbXBvcnRhbnQNCiAgYm9yZGVyLWNvbG9yOiAjRTVFNkVCICFpbXBvcnRhbnQNCg0KICAmOmZvY3VzLXdpdGhpbg0KICAgIGJveC1zaGFkb3c6IDAgMCAwIDJweCByZ2JhKDY0LCAxNTgsIDI1NSwgMC4yKSAhaW1wb3J0YW50DQoNCi5zZW5kLWJ0bg0KICBib3JkZXItcmFkaXVzOiAyNHB4ICFpbXBvcnRhbnQNCiAgcGFkZGluZzogMCAyNHB4ICFpbXBvcnRhbnQNCiAgaGVpZ2h0OiA0MHB4ICFpbXBvcnRhbnQNCiAgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQNCiAgdHJhbnNpdGlvbiBhbGwgMC4ycyBlYXNlDQoNCiAgJjpob3Zlcg0KICAgIGJhY2tncm91bmQtY29sb3I6ICMzMzkxRkYgIWltcG9ydGFudA0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KQ0KDQogICY6YWN0aXZlDQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApDQoNCi8vIOWKqOeUu+aViOaenA0KQGtleWZyYW1lcyBmYWRlSW4NCiAgZnJvbQ0KICAgIG9wYWNpdHk6IDANCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTBweCkNCiAgdG8NCiAgICBvcGFjaXR5OiAxDQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApDQoNCi8vIOWvueivneahhuagt+W8j+S8mOWMlg0KLmVsLWRpYWxvZ19faGVhZGVyDQogIGJhY2tncm91bmQtY29sb3IgJHByaW1hcnktY29sb3INCiAgY29sb3I6ICNmZmYgIWltcG9ydGFudA0KICBib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMA0KDQouZWwtZGlhbG9nX190aXRsZQ0KICBjb2xvcjogI2ZmZiAhaW1wb3J0YW50DQogIGZvbnQtc2l6ZTogMTZweCAhaW1wb3J0YW50DQoNCi5lbC1kaWFsb2dfX2JvZHkNCiAgcGFkZGluZzogMjBweCAhaW1wb3J0YW50DQoNCi5lbC1pbnB1dF9faW5uZXINCiAgYm9yZGVyLXJhZGl1czogMjBweCAhaW1wb3J0YW50DQogIGhlaWdodDogNDBweCAhaW1wb3J0YW50DQogIGxpbmUtaGVpZ2h0OiA0MHB4ICFpbXBvcnRhbnQNCg0KLmVsLWJ1dHRvbi0tcHJpbWFyeQ0KICBib3JkZXItcmFkaXVzOiAyMHB4ICFpbXBvcnRhbnQNCiAgcGFkZGluZzogMCAyMHB4ICFpbXBvcnRhbnQNCg0KLy8g5YW85a655YW25LuW5rWP6KeI5Zmo55qE5rua5Yqo5p2h6ZqQ6JeP77yI5Y+v6YCJ77yJDQpAbWVkaWEgc2NyZWVuIGFuZCAoLXdlYmtpdC1taW4tZGV2aWNlLXBpeGVsLXJhdGlvOiAwKQ0KICAuYmxvZy1jaGF0LS1jb250ZW50DQogICAgc2Nyb2xsYmFyLXdpZHRoOiBub25lDQogICAgLW1zLW92ZXJmbG93LXN0eWxlOiBub25lDQoNCi5ibG9nLWNoYXQtLWNvbnRlbnQ6Oi13ZWJraXQtc2Nyb2xsYmFyDQogIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudA0K"},{"version":3,"sources":["Socket.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Socket.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"blog-chat\">\r\n    <div class=\"blog-chat--header\">\r\n      <i class=\"el-icon-comments\"></i>\r\n      <span>实时聊天室</span>\r\n    </div>\r\n    <div class=\"blog-chat--content\">\r\n      <div class=\"blog-chat--item\" :class=\"chat.dis\" v-for=\"chat in chatList\" :key=\"chat.time + chat.nikname\">\r\n\r\n        <span v-if=\"chat.nikname && chat.type !== 'action'\" class=\"blog-chat--nikname\">{{ chat.nikname }}</span>\r\n        <div class=\"blog-chat--box\" :class=\"{ action: chat.type === 'action' }\">\r\n          <span class=\"blog-chat--time\" v-if=\"chat.time && chat.type !== 'action'\">{{ chat.time }}</span>\r\n          <p class=\"blog-chat--msg\" v-if=\"chat.msg\">{{ chat.msg }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"blog-chat--bottom\">\r\n      <el-input v-model=\"sendMsg\" placeholder=\"请输入聊天内容...\" class=\"chat-input\" @keyup.enter=\"sendChat\">\r\n      </el-input>\r\n      <el-button type=\"primary\" @click=\"sendChat\" icon=\"el-icon-position\" class=\"send-btn\">\r\n        发送\r\n      </el-button>\r\n    </div>\r\n\r\n    <el-dialog title=\"设置昵称\" :visible=\"dialogVisible\" width=\"30%\" :close-on-click-modal=\"false\">\r\n      <el-input v-model=\"nikname\" placeholder=\"请输入你的昵称\" :maxlength=\"10\" show-word-limit>\r\n      </el-input>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"login\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { io } from 'socket.io-client'\r\nimport formatDate from '@/util/formatDate'\r\n\r\nexport default {\r\n  name: 'SocketChat',\r\n  data() {\r\n    return {\r\n      sendMsg: '',\r\n      chatList: [],\r\n      nikname: '',\r\n      ws: null,\r\n      dialogVisible: false\r\n    };\r\n  },\r\n  created() {\r\n    this.$store.commit('RIGHT_LIVE2D_DIS')\r\n    this.getNikname()\r\n\r\n    // 连接Socket\r\n    this.ws = io(\"ws://127.0.0.1:8888\", { transports: ['websocket'] })\r\n\r\n    this.ws.on('connect', () => {\r\n      console.log('建立连接')\r\n      // 已登录用户自动发送登录状态\r\n      if (this.nikname) {\r\n        this.ws.emit('login', this.nikname)\r\n      }\r\n    })\r\n\r\n    this.ws.on('chat', (data) => {\r\n      this.serverChat(data)\r\n    })\r\n\r\n    this.ws.on('logout', (nikname) => {\r\n      this.serverLog({ nikname, isLogin: false })\r\n    })\r\n\r\n    this.ws.on('logged', (nikname) => {\r\n      this.serverLog({ nikname, isLogin: true })\r\n    })\r\n\r\n    // 监听连接错误\r\n    this.ws.on('error', (error) => {\r\n      console.error('Socket连接错误:', error)\r\n      this.addChat({\r\n        type: 'action',\r\n        msg: '连接聊天室失败，请刷新页面重试'\r\n      })\r\n    })\r\n  },\r\n  beforeDestroy() {\r\n    this.$store.commit('LEFT_LIVE2D_DIS')\r\n    // 关闭socket连接\r\n    if (this.ws) {\r\n      this.ws.close()\r\n    }\r\n  },\r\n  updated() {\r\n    // 滚动到底部\r\n    const content = this.$el.querySelector('.blog-chat--content')\r\n    if (content) {\r\n      content.scrollTop = content.scrollHeight\r\n    }\r\n  },\r\n  methods: {\r\n    getNikname() {\r\n      let nikname = this.$store.getters.userInfo?.nikname\r\n      this.dialogVisible = !nikname\r\n      this.nikname = nikname || ''\r\n    },\r\n    login() {\r\n      if (!this.nikname.trim()) {\r\n        this.$message.warning('请输入有效的昵称')\r\n        return\r\n      }\r\n      this.ws.emit('login', this.nikname.trim())\r\n      this.dialogVisible = false\r\n      // 保存昵称到store\r\n      this.$store.commit('SET_USER_INFO', {\r\n        ...this.$store.getters.userInfo,\r\n        nikname: this.nikname.trim()\r\n      })\r\n    },\r\n    addChat({\r\n      type = \"msg\",\r\n      msg = \"\",\r\n      nikname = '',\r\n      time = formatDate(),\r\n      isMe = false\r\n    }) {\r\n      let dis = 'left'\r\n      if (type === 'action') {\r\n        dis = 'center'\r\n      }\r\n      if (isMe) {\r\n        dis = 'right'\r\n      }\r\n      this.chatList.push({\r\n        type, msg, nikname, time, isMe, dis\r\n      })\r\n    },\r\n    sendChat() {\r\n      const msg = this.sendMsg.trim()\r\n      if (!msg) {\r\n        this.$message.warning('请输入聊天内容')\r\n        return\r\n      }\r\n      if (!this.nikname) {\r\n        this.dialogVisible = true\r\n        return\r\n      }\r\n\r\n      this.addChat({\r\n        isMe: true,\r\n        msg,\r\n        nikname: this.nikname\r\n      })\r\n      this.ws.emit('send', {\r\n        msg,\r\n        nikname: this.nikname,\r\n        time: formatDate()\r\n      })\r\n      this.sendMsg = ''\r\n    },\r\n    serverChat(data) {\r\n      // 解构时增加容错，避免字段缺失导致显示匿名\r\n      console.log('接收到服务器消息：', data);\r\n      const { msg = '', nikname = '', time = '' } = data || {};\r\n      // 新增：如果 nikname 为空，显示「未知用户」（比匿名用户更准确）\r\n      const showNikname = nikname.trim() || '未知用户';\r\n\r\n      this.addChat({\r\n        nikname: showNikname,\r\n        msg: msg.trim() || '空消息',\r\n        time: time || formatDate() // 后端没传时间时，前端补全\r\n      })\r\n    },\r\n    serverLog({ nikname, isLogin }) {\r\n      const state = isLogin ? '进入' : '离开'\r\n      const msg = `${nikname} ${state}了聊天室`\r\n      this.addChat({\r\n        type: 'action', msg\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n// 全局样式变量\r\n$primary-color = #409EFF\r\n$secondary-color = #67C23A\r\n$gray-light = #F5F7FA\r\n$gray = #C0C4CC\r\n$gray-dark = #909399\r\n$text-color = #303133\r\n$bg-color = #F7F9FC\r\n$border-radius = 18px\r\n$shadow = 0 2px 12px rgba(0, 0, 0, 0.08)\r\n\r\n.blog-chat\r\n  display flex\r\n  flex-direction column\r\n  width 100%\r\n  max-width 800px  // 限制最大宽度\r\n  margin 10px auto\r\n  background-color #fff\r\n  border-radius 12px\r\n  box-shadow 0 4px 20px rgba(0, 0, 0, 0.1)\r\n  height 68vh\r\n  overflow hidden\r\n  transition all 0.3s ease\r\n\r\n  // 响应式调整\r\n  @media (max-width: 768px)\r\n    width 95%\r\n    height 75vh\r\n\r\n.blog-chat--header\r\n  display flex\r\n  align-items center\r\n  padding 16px 20px\r\n  background-color $primary-color\r\n  color #fff\r\n  font-size 18px\r\n  font-weight 500\r\n\r\n  i.el-icon-comments\r\n    margin-right 8px\r\n    font-size 20px\r\n\r\n.blog-chat--content\r\n  flex 1\r\n  padding 20px\r\n  overflow-y auto\r\n  background-color $bg-color\r\n  scroll-behavior smooth  // 平滑滚动\r\n\r\n  // 滚动条样式（如果需要隐藏，可注释这段）\r\n  &::-webkit-scrollbar\r\n    width 6px\r\n    height 6px\r\n\r\n  &::-webkit-scrollbar-thumb\r\n    background-color $gray\r\n    border-radius 3px\r\n\r\n  &::-webkit-scrollbar-track\r\n    background-color transparent\r\n\r\n// 修复核心：消息项容器样式\r\n.blog-chat--item\r\n  display flex\r\n  margin-bottom 16px\r\n  animation fadeIn 0.3s ease  // 消息出现动画\r\n  width: 100%  // 确保占满宽度\r\n\r\n  // 左侧消息（他人）- 靠左\r\n  &.left\r\n    justify-content: flex-start\r\n    flex-direction: row\r\n\r\n    .blog-chat--nikname\r\n      margin-right: 8px\r\n      color $gray-dark\r\n      font-size 12px\r\n      align-self: flex-start\r\n      margin-top: 2px\r\n\r\n    .blog-chat--box\r\n      background-color #fff\r\n      border 1px solid #E5E6EB\r\n      margin-left: 0  // 移除多余边距\r\n\r\n  // 右侧消息（自己）- 靠右（关键修复）\r\n  &.right\r\n    justify-content: flex-end  // 整体靠右\r\n    flex-direction: row  // 不需要反向，直接调整内部顺序\r\n    align-items: flex-start\r\n\r\n    // 自己的昵称在右边，所以margin-left\r\n    .blog-chat--nikname\r\n      margin-left: 8px\r\n      color $gray-dark\r\n      font-size 12px\r\n      align-self: flex-start\r\n      margin-top: 2px\r\n      order: 2  // 让昵称在消息框右边\r\n\r\n    .blog-chat--box\r\n      background-color $primary-color\r\n      color #fff\r\n      margin-right: 0  // 移除多余边距\r\n      order: 1  // 让消息框在昵称左边\r\n\r\n  // 中间系统消息\r\n  &.center\r\n    justify-content: center\r\n    flex-direction: row\r\n\r\n    .blog-chat--box\r\n      background-color #F0F2F5\r\n      color $gray-dark\r\n      font-size 13px\r\n      padding 6px 12px\r\n      border-radius 12px\r\n      max-width: 60%\r\n\r\n.blog-chat--nikname\r\n  font-size 12px\r\n  font-weight 500\r\n  margin-bottom 4px\r\n  display: inline-block\r\n\r\n.blog-chat--box\r\n  max-width: 70%  // 限制消息最大宽度\r\n  padding: 10px 14px\r\n  border-radius $border-radius\r\n  box-shadow $shadow\r\n  position: relative\r\n  transition all 0.2s ease\r\n  word-wrap: break-word  // 确保长文本换行\r\n\r\n  // 系统消息样式\r\n  &.action\r\n    background-color #F0F2F5\r\n    color $gray-dark\r\n    text-align: center\r\n    box-shadow: none\r\n    border-radius: 12px\r\n\r\n  // 气泡尖角 - 左侧消息\r\n  .left &::before\r\n    content: ''\r\n    position: absolute\r\n    left: -8px\r\n    top: 12px\r\n    width: 0\r\n    height: 0\r\n    border-top: 8px solid transparent\r\n    border-bottom: 8px solid transparent\r\n    border-right: 8px solid #fff\r\n    z-index: 1\r\n\r\n  // 气泡尖角 - 右侧消息（修复方向）\r\n  .right &::before\r\n    content: ''\r\n    position: absolute\r\n    right: -8px  // 尖角在右侧\r\n    top: 12px\r\n    width: 0\r\n    height: 0\r\n    border-top: 8px solid transparent\r\n    border-bottom: 8px solid transparent\r\n    border-left: 8px solid $primary-color  // 与自己消息框颜色一致\r\n    z-index: 1\r\n\r\n.blog-chat--time\r\n  font-size: 11px\r\n  color $gray\r\n  margin-bottom: 4px\r\n  display: block\r\n\r\n  // 自己消息的时间颜色\r\n  .right &\r\n    color: rgba(255, 255, 255, 0.7)\r\n\r\n.blog-chat--msg\r\n  font-size: 14px\r\n  line-height: 1.6\r\n  margin: 0\r\n  word-break: break-all  // 自动换行\r\n  white-space: normal\r\n\r\n.blog-chat--bottom\r\n  display: flex\r\n  gap: 12px\r\n  padding: 16px 20px\r\n  background-color #fff\r\n  border-top: 1px solid #F0F2F5\r\n  align-items: center  // 输入框和按钮垂直居中\r\n\r\n.chat-input\r\n  flex: 1\r\n  border-radius: 24px !important\r\n  border-color: #E5E6EB !important\r\n\r\n  &:focus-within\r\n    box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2) !important\r\n\r\n.send-btn\r\n  border-radius: 24px !important\r\n  padding: 0 24px !important\r\n  height: 40px !important\r\n  font-size: 14px !important\r\n  transition all 0.2s ease\r\n\r\n  &:hover\r\n    background-color: #3391FF !important\r\n    transform: translateY(-1px)\r\n\r\n  &:active\r\n    transform: translateY(0)\r\n\r\n// 动画效果\r\n@keyframes fadeIn\r\n  from\r\n    opacity: 0\r\n    transform: translateY(10px)\r\n  to\r\n    opacity: 1\r\n    transform: translateY(0)\r\n\r\n// 对话框样式优化\r\n.el-dialog__header\r\n  background-color $primary-color\r\n  color: #fff !important\r\n  border-radius: 8px 8px 0 0\r\n\r\n.el-dialog__title\r\n  color: #fff !important\r\n  font-size: 16px !important\r\n\r\n.el-dialog__body\r\n  padding: 20px !important\r\n\r\n.el-input__inner\r\n  border-radius: 20px !important\r\n  height: 40px !important\r\n  line-height: 40px !important\r\n\r\n.el-button--primary\r\n  border-radius: 20px !important\r\n  padding: 0 20px !important\r\n\r\n// 兼容其他浏览器的滚动条隐藏（可选）\r\n@media screen and (-webkit-min-device-pixel-ratio: 0)\r\n  .blog-chat--content\r\n    scrollbar-width: none\r\n    -ms-overflow-style: none\r\n\r\n.blog-chat--content::-webkit-scrollbar\r\n  display: none !important\r\n</style>"]}]}