{"remainingRequest":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\githubdesk\\Vue-blog\\vue-blog\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\src\\views\\Home.vue","mtime":1762829935117},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\githubdesk\\Vue-blog\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIEAgaXMgYW4gYWxpYXMgdG8gL3NyYwppbXBvcnQgQmFzZU1vZGFsIGZyb20gJ0AvY29tcG9uZW50cy9iYXNlL0Jhc2VNb2RhbCcKaW1wb3J0IEJhc2VIZWFkZXIgZnJvbSAnQC9jb21wb25lbnRzL2Jhc2UvQmFzZUhlYWRlcicKaW1wb3J0IEJhc2VBc2lkZSBmcm9tICdAL2NvbXBvbmVudHMvYmFzZS9CYXNlQXNpZGUnCmltcG9ydCBCYXNlV2VsY29tZSBmcm9tICdAL2NvbXBvbmVudHMvYmFzZS9CYXNlV2VsY29tZScKaW1wb3J0IENpcmNsZU1lbnUgZnJvbSAndnVlLWNpcmNsZS1tZW51JwppbXBvcnQgTGl2ZTJEIGZyb20gJ0AvY29tcG9uZW50cy9MaXZlMmQnICAKaW1wb3J0IE1JTlhJTiBmcm9tICdAL2NvcmUvbWlueGluJwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0hvbWUnLAogIG1peGluczogW01JTlhJTl0sCiAgY29tcG9uZW50czogewogICAgQmFzZU1vZGFsLCBCYXNlSGVhZGVyLCBCYXNlQXNpZGUsIEJhc2VXZWxjb21lLCBDaXJjbGVNZW51LExpdmUyRAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBpc1JvdXRlTG9hZGluZzogdHJ1ZQogICAgfQogIH0sCgogIHByb3ZpZGUoKSB7CiAgICByZXR1cm4gewogICAgICAnY2xvc2VMb2FkQ2xvY2snOiB0aGlzLmNsb3NlTG9hZENsb2NrCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgd2VsY29tZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLndlbGNvbWUKICAgIH0sCiAgICBpbmRleCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLnBhdGggPT09ICcvaW5kZXgnCiAgICB9LAogICAgYXJ0aWNsZXRvb2xzKCkgewogICAgICBjb25zdCBiYXNpY1BhdGggPSAvXlwvYXJ0aWNsZVwvLiovCiAgICAgIHJldHVybiBiYXNpY1BhdGgudGVzdCh0aGlzLiRyb3V0ZS5wYXRoKQogICAgfSwKICAgIGNvbHVtbnRvb2xzKCkgewogICAgICByZXR1cm4gdGhpcy4kcm91dGUucGF0aCA9PT0gJy9jb2x1bW4nCiAgICB9LAogICAgdXNlckluZm8oKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mbwogICAgfQogIH0sCgogIGJlZm9yZVJvdXRlRW50ZXIodG8sIGZyb20sIG5leHQpIHsKICAgIG5leHQodm0gPT4gewogICAgICBpZiAodG8ucGF0aCA9PT0gJy9pbmRleCcpIHsKICAgICAgICB2bS5yZWZyZXNoRGF0YSgpOwogICAgICB9CiAgICB9KTsKICB9LAogIGJlZm9yZVJvdXRlVXBkYXRlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICBpZiAodG8ucGF0aCA9PT0gJy9pbmRleCcpIHsKICAgICAgdGhpcy5yZWxvYWQoKQoKICAgIH0KICAgIGlmICh0aGlzLiRyb3V0ZS5wYXRoID09PSAnL2luZGV4JykgewogICAgICB0aGlzLnJlbG9hZCgpCiAgICB9CiAgICBuZXh0KCk7CiAgfSwKICBtb3VudGVkKCkgewogICAgLy8g6aG16Z2i5oyC6L295pe25Lmf5Y+v5Lul5qOA5p+l5LiA5qyhCiAgICBpZiAodGhpcy4kcm91dGUucGF0aCA9PT0gJy9pbmRleCcpIHsKCiAgICAgIHRoaXMucmVsb2FkKCkKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICB1c2VySW5mbzogewogICAgICBkZWVwOiB0cnVlLAogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy/ph43ovb1yb3V0ZS12aWV3CiAgICByZWxvYWQoKSB7CiAgICAgIHRoaXMuaXNSb3V0ZUxvYWRpbmcgPSBmYWxzZQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy5pc1JvdXRlTG9hZGluZyA9IHRydWUKICAgICAgfSk7CiAgICB9LAogICAgY2xvc2VMb2FkQ2xvY2soKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICB9LAogICAgYWRkQ29sdW1uKCkgewogICAgICB0aGlzLnJlZnJlc2hNb2RhbCgncG9zdENvbHVtbicpCiAgICB9LAogICAgYXN5bmMgaW5jQXJ0aWNsZUxpa2VOdW0oKSB7CiAgICAgIC8vIOiOt+WPluW9k+WJjeaWh+eroOeahOeCuei1nuaVsO+8jOehruS/neaYr+aVsOWtl+exu+WeiwogICAgICBsZXQgY3VycmVudExpa2VOdW0gPSAwOwoKICAgICAgLy8g5LuO5b2T5YmN6Lev55Sx5Y+C5pWw6I635Y+W5paH56ugSUQKICAgICAgY29uc3QgYXJ0aWNsZUlkID0gdGhpcy4kcm91dGUucGFyYW1zLmlkOwoKICAgICAgaWYgKCFhcnRpY2xlSWQpIHsKICAgICAgICB0aGlzLiRub3RpZnkuZXJyb3IoewogICAgICAgICAgbWVzc2FnZTogJ+aXoOazleiOt+WPluaWh+eroOS/oeaBrycKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgLy8g6aaW5YWI6I635Y+W5paH56ug5b2T5YmN55qE54K56LWe5pWwCiAgICAgICAgY29uc3QgYXJ0aWNsZVJlcyA9IGF3YWl0IHRoaXMuJGFwaSh7CiAgICAgICAgICB0eXBlOiAnZ2V0QXJ0aWNsZUJ5SWQnLAogICAgICAgICAgZGF0YTogeyBpZDogYXJ0aWNsZUlkIH0KICAgICAgICB9KTsKCiAgICAgICAgY3VycmVudExpa2VOdW0gPSBwYXJzZUludChhcnRpY2xlUmVzLmxpa2VfbnVtKSB8fCAwOwoKICAgICAgICAvLyDlop7liqDngrnotZ7mlbAKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRhcGkoewogICAgICAgICAgdHlwZTogJ3B1dEFydGljbGVMaWtlTnVtJywKICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgbGlrZV9udW06IGN1cnJlbnRMaWtlTnVtICsgMSAgLy8g56Gu5L+d5piv5pWw5a2XCiAgICAgICAgICB9LAogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIGlkOiBhcnRpY2xlSWQKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgICAgIC8vIOehruS/neWtmOWCqOeahOaYr+aVsOWtl+exu+WeiwogICAgICAgICAgY29uc3QgbmV3TGlrZU51bSA9IHBhcnNlSW50KHJlcy5saWtlX251bSkgfHwgMDsKICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdsaWtlX251bScsIG5ld0xpa2VOdW0udG9TdHJpbmcoKSk7CgogICAgICAgICAgdGhpcy4kbm90aWZ5LnN1Y2Nlc3MoewogICAgICAgICAgICBtZXNzYWdlOiAn5bey54K56LWe77yBJwogICAgICAgICAgfSk7CgogICAgICAgICAgLy8g6YCa55+l5YW25LuW57uE5Lu25pu05paw5pWw5o2uCiAgICAgICAgICB0aGlzLiRFdmVudEJ1cy4kZW1pdCgnYXJ0aWNsZS1saWtlLXVwZGF0ZWQnLCB7CiAgICAgICAgICAgIGlkOiBhcnRpY2xlSWQsCiAgICAgICAgICAgIGxpa2VfbnVtOiBuZXdMaWtlTnVtCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign54K56LWe5aSx6LSlOicsIGVycm9yKTsKICAgICAgICB0aGlzLiRub3RpZnkuZXJyb3IoewogICAgICAgICAgbWVzc2FnZTogJ+eCuei1nuWksei0pTogJyArIGVycm9yLm1lc3NhZ2UKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGRlbGV0ZUNvbHVtbigpIHsKICAgICAgdGhpcy5yZWZyZXNoTW9kYWwoJ2RlbGV0ZUNvbHVtbicpCiAgICB9LAogICAgcmVmcmVzaERhdGEoKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5zdGF0ZS50b2tlbikgewogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdnZXRVc2VySW5mbycpOwogICAgICB9CiAgICB9LAogICAgcmVmcmVzaEFsbCgpIHsKICAgICAgY29uc29sZS5sb2coJ3JlZnJlc2hBbGwnKQogICAgICBsb2NhdGlvbi5yZWxvYWQoKQogICAgfQogIH0KfQo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"blog-page\">\n    <el-container class=\"blog-container\" v-if=\"welcome\">\n      <el-header class=\"blog-header\">\n        <BaseHeader />\n      </el-header>\n      <el-container class=\"blog-middle\">\n\n        <el-row class=\"blog-middle--wrap\" type=\"flex\" justify=\"flex-wrap\" align=\"center\">\n          <el-col :span=\"6\" class=\"hidden-md-and-down\">\n            <BaseAside v-if=\"$store.state.userInfo\" />\n          </el-col>\n\n          <el-col :span=\"24\" :lg=\"{ span: 24 }\">\n            <el-main class=\"blog-main\">\n              <keep-alive include=\"ArticleList\">\n                <router-view v-if=\"isRouteLoading\" :loading=\"loading\"></router-view>\n              </keep-alive>\n            </el-main>\n          </el-col>\n          <el-col :span=\"1\">\n            <CircleMenu type='bottom' :number='3' :colors=\"['#ebc08e', '#ebc08e', '#ebc08e', '#ebc08e', '#ebc08e']\"\n              circle btn class=\"circle-menu\" v-if=\"index\">\n              <router-link tag=\"i\" slot=\"item_1\" class=\"el-icon-edit\" to=\"/editor\"></router-link>\n              <router-link tag=\"i\" slot=\"item_2\" class=\"el-icon-star-on\" to=\"/like\"></router-link>\n              <i slot=\"item_3\" class=\"el-icon-refresh-left\" @click=\"refreshAll()\"></i>\n\n            </CircleMenu>\n            <CircleMenu type='bottom' :number='3' :colors=\"['#ebc08e', '#ebc08e', '#ebc08e', '#ebc08e', '#ebc08e']\"\n              circle btn class=\"circle-menu\" v-if=\"articletools\">\n              <router-link tag=\"i\" slot=\"item_1\" class=\"el-icon-edit\" to=\"/editor\"></router-link>\n              <i slot=\"item_2\" class=\"el-icon-star-on\" @click=\"incArticleLikeNum\"></i>\n              <router-link tag=\"i\" slot=\"item_3\" class=\"el-icon-download\" to=\"/download\"></router-link>\n            </CircleMenu>\n            <CircleMenu type='bottom' :number='2' :colors=\"['#ebc08e', '#ebc08e', '#ebc08e', '#ebc08e', '#ebc08e']\"\n              circle btn class=\"circle-menu\" v-if=\"columntools\">\n              <i tag=\"i\" slot=\"item_1\" class=\"el-icon-circle-plus-outline\" @click=\"addColumn\"></i>\n              <i tag=\"i\" slot=\"item_2\" class=\"el-icon-delete\" @click=\"deleteColumn\"></i>\n            </CircleMenu>\n          </el-col>\n        </el-row>\n      </el-container>\n      <el-footer height=\"10vh\" class=\"blog-footer\">底部</el-footer>\n    </el-container>\n    <div v-else class=\"blog-welcome\">\n      <BaseWelcome />\n    </div>\n    <BaseModal />\n    <Live2D />\n  </div>\n\n</template>\n\n<script>\n// @ is an alias to /src\nimport BaseModal from '@/components/base/BaseModal'\nimport BaseHeader from '@/components/base/BaseHeader'\nimport BaseAside from '@/components/base/BaseAside'\nimport BaseWelcome from '@/components/base/BaseWelcome'\nimport CircleMenu from 'vue-circle-menu'\nimport Live2D from '@/components/Live2d'  \nimport MINXIN from '@/core/minxin'\nexport default {\n  name: 'Home',\n  mixins: [MINXIN],\n  components: {\n    BaseModal, BaseHeader, BaseAside, BaseWelcome, CircleMenu,Live2D\n  },\n  data() {\n    return {\n      loading: false,\n      isRouteLoading: true\n    }\n  },\n\n  provide() {\n    return {\n      'closeLoadClock': this.closeLoadClock\n    }\n  },\n  computed: {\n    welcome() {\n      return this.$store.state.welcome\n    },\n    index() {\n      return this.$route.path === '/index'\n    },\n    articletools() {\n      const basicPath = /^\\/article\\/.*/\n      return basicPath.test(this.$route.path)\n    },\n    columntools() {\n      return this.$route.path === '/column'\n    },\n    userInfo() {\n      return this.$store.state.userInfo\n    }\n  },\n\n  beforeRouteEnter(to, from, next) {\n    next(vm => {\n      if (to.path === '/index') {\n        vm.refreshData();\n      }\n    });\n  },\n  beforeRouteUpdate(to, from, next) {\n    if (to.path === '/index') {\n      this.reload()\n\n    }\n    if (this.$route.path === '/index') {\n      this.reload()\n    }\n    next();\n  },\n  mounted() {\n    // 页面挂载时也可以检查一次\n    if (this.$route.path === '/index') {\n\n      this.reload()\n    }\n  },\n  watch: {\n    userInfo: {\n      deep: true,\n    }\n  },\n  methods: {\n    //重载route-view\n    reload() {\n      this.isRouteLoading = false\n      this.$nextTick(() => {\n        this.isRouteLoading = true\n      });\n    },\n    closeLoadClock() {\n      this.loading = false\n    },\n    addColumn() {\n      this.refreshModal('postColumn')\n    },\n    async incArticleLikeNum() {\n      // 获取当前文章的点赞数，确保是数字类型\n      let currentLikeNum = 0;\n\n      // 从当前路由参数获取文章ID\n      const articleId = this.$route.params.id;\n\n      if (!articleId) {\n        this.$notify.error({\n          message: '无法获取文章信息'\n        });\n        return;\n      }\n\n      try {\n        // 首先获取文章当前的点赞数\n        const articleRes = await this.$api({\n          type: 'getArticleById',\n          data: { id: articleId }\n        });\n\n        currentLikeNum = parseInt(articleRes.like_num) || 0;\n\n        // 增加点赞数\n        const res = await this.$api({\n          type: 'putArticleLikeNum',\n          data: {\n            like_num: currentLikeNum + 1  // 确保是数字\n          },\n          params: {\n            id: articleId\n          }\n        });\n\n        if (res) {\n          console.log(res);\n          // 确保存储的是数字类型\n          const newLikeNum = parseInt(res.like_num) || 0;\n          localStorage.setItem('like_num', newLikeNum.toString());\n\n          this.$notify.success({\n            message: '已点赞！'\n          });\n\n          // 通知其他组件更新数据\n          this.$EventBus.$emit('article-like-updated', {\n            id: articleId,\n            like_num: newLikeNum\n          });\n        }\n      } catch (error) {\n        console.error('点赞失败:', error);\n        this.$notify.error({\n          message: '点赞失败: ' + error.message\n        });\n      }\n    },\n    deleteColumn() {\n      this.refreshModal('deleteColumn')\n    },\n    refreshData() {\n      if (this.$store.state.token) {\n        this.$store.dispatch('getUserInfo');\n      }\n    },\n    refreshAll() {\n      console.log('refreshAll')\n      location.reload()\n    }\n  }\n}\n</script>\n<style lang=\"stylus\">\n.blog-container\n  overflow hidden\n.blog-middle\n  padding 20px\n  height calc(100vh - 60px - 10vh)\n  background-color #f1f1f1\n.el-main.blog-main\n  padding 0 20px\n  height 100%\n.blog-middle--wrap\n  min-width: 1220px\n  width 100%\n.blog-footer\n  height 10vh\n  background-color #2D2F33\n.circle-menu\n  margin-top: 1vh\n  width: 55%\n  scale: 0.8\n.circle-menu i\n  color: white\n  scale: 1.2\n  transform: transition( all 0.3s ease )\n.circle-menu i:hover\n  scale: 1.5\n  transform: transition( all 0.3s ease )\n\n</style>\n"]}]}